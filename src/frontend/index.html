<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoneyParadise ì‹¤ì‹œê°„ ë°ì´í„° ëŒ€ì‹œë³´ë“œ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script> -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            color: #1f2937;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
        }

        .header h1 {
            color: #1f2937;
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 12px;
            text-align: center;
            line-height: 1.2;
        }

        .header p {
            text-align: center;
            color: #6b7280;
            font-size: 1.1em;
            line-height: 1.5;
            max-width: 600px;
            margin: 0 auto;
        }

        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .status-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            transition: all 0.2s ease;
        }

        .status-card:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .status-card .icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .status-card .title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2d3748;
        }

        .status-card .value {
            font-size: 1.5em;
            font-weight: 700;
            color: #4299e1;
        }

        .status-card .subtitle {
            font-size: 0.9em;
            color: #718096;
            margin-top: 5px;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .symbol-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            transition: all 0.2s ease;
            border-left: 4px solid #2563eb;
        }

        .symbol-card:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .symbol-card.up {
            border-left-color: #059669;
        }

        .symbol-card.down {
            border-left-color: #dc2626;
        }

        .symbol-card.neutral {
            border-left-color: #6b7280;
        }

        .symbol-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .symbol-name {
            font-size: 1.3em;
            font-weight: 700;
            color: #2d3748;
        }

        .symbol-source {
            font-size: 0.8em;
            color: #718096;
            background: #e2e8f0;
            padding: 4px 8px;
            border-radius: 8px;
        }

        .price-info {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 15px;
        }

        .price-main {
            text-align: left;
        }

        .current-price {
            font-size: 2em;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .change-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .change {
            font-size: 1.1em;
            font-weight: 600;
        }

        .change.up {
            color: #48bb78;
        }

        .change.down {
            color: #f56565;
        }

        .change.neutral {
            color: #718096;
        }

        .change-percent {
            font-size: 0.9em;
            padding: 2px 6px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.05);
        }

        .price-details {
            text-align: right;
        }

        .price-item {
            font-size: 0.9em;
            color: #718096;
            margin-bottom: 2px;
        }

        .price-item span {
            color: #2d3748;
            font-weight: 600;
        }

        .update-time {
            font-size: 0.8em;
            color: #a0aec0;
            margin-top: 10px;
            text-align: center;
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .controls h3 {
            color: #2d3748;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: #1d4ed8;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn.loading {
            background: #6b7280;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        .status-indicator.success { background: #059669; }
        .status-indicator.warning { background: #d97706; }
        .status-indicator.error { background: #dc2626; }
        .status-indicator.info { background: #2563eb; }
        .status-indicator.loading { background: #6b7280; }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 8px;
            padding: 16px 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-left: 4px solid #2563eb;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 350px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success { border-left-color: #059669; }
        .notification.error { border-left-color: #dc2626; }
        .notification.warning { border-left-color: #d97706; }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2563eb, #3b82f6);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        /* TradingView ìŠ¤íƒ€ì¼ ì°¨íŠ¸ ì¸í„°í˜ì´ìŠ¤ */
        .chart-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: #f8fafc;
            border-bottom: 1px solid #e5e7eb;
        }

        .symbol-info h2 {
            margin: 0;
            font-size: 1.8em;
            font-weight: 700;
            color: #1f2937;
        }

        .market-info {
            color: #6b7280;
            font-size: 0.9em;
            margin-top: 4px;
        }

        .price-info {
            text-align: right;
        }

        .current-price {
            margin-bottom: 8px;
        }

        .current-price .price {
            font-size: 1.5em;
            font-weight: 700;
            color: #1f2937;
        }

        .current-price .change {
            margin-left: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
        }

        .current-price .change.positive {
            background: #dcfce7;
            color: #059669;
        }

        .current-price .change.negative {
            background: #fef2f2;
            color: #dc2626;
        }

        .price-details {
            display: flex;
            gap: 16px;
            font-size: 0.9em;
        }

        .price-item {
            display: flex;
            gap: 4px;
        }

        .price-item .label {
            color: #6b7280;
        }

        .price-item .value {
            font-weight: 600;
            color: #1f2937;
        }

        .chart-main {
            height: 400px;
            position: relative;
        }

        .chart-area {
            height: 100%;
            background: #fafafa;
            border-bottom: 1px solid #e5e7eb;
            position: relative;
        }

        .chart-placeholder {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chart-message {
            text-align: center;
            color: #6b7280;
        }

        .chart-message h3 {
            margin: 0 0 8px 0;
            font-size: 1.2em;
        }

        .chart-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background: #f8fafc;
            border-bottom: 1px solid #e5e7eb;
        }

        .timeframe-selector {
            display: flex;
            gap: 4px;
        }

        .timeframe-btn {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            background: white;
            color: #6b7280;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s ease;
        }

        .timeframe-btn:hover {
            background: #f3f4f6;
        }

        .timeframe-btn.active {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .chart-tools {
            display: flex;
            gap: 8px;
        }

        .tool-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #d1d5db;
            background: white;
            color: #6b7280;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .tool-btn:hover {
            background: #f3f4f6;
            color: #2563eb;
        }

        .indicators-panel {
            padding: 20px;
            background: white;
        }

        .indicators-panel h4 {
            margin: 0 0 16px 0;
            font-size: 1.1em;
            font-weight: 600;
            color: #1f2937;
        }

        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .indicator-item {
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .indicator-label {
            font-size: 0.9em;
            color: #6b7280;
            margin-bottom: 4px;
        }

        .indicator-value {
            font-size: 1.1em;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .indicator-status {
            font-size: 0.8em;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 500;
        }

        .indicator-status.bullish {
            background: #dcfce7;
            color: #059669;
        }

        .indicator-status.bearish {
            background: #fef2f2;
            color: #dc2626;
        }

        .indicator-status.neutral {
            background: #f3f4f6;
            color: #6b7280;
        }

        .indicator-status.warning {
            background: #fef3c7;
            color: #d97706;
        }

        .loading-message {
            margin-top: 20px;
            padding: 16px;
            background: #eff6ff;
            border-radius: 8px;
            border: 1px solid #bfdbfe;
        }

        .loading-message p {
            margin: 0;
            color: #1e40af;
            text-align: center;
        }

        .btn.secondary {
            background: #059669;
        }

        .btn.secondary:hover {
            background: #047857;
        }

        .btn.danger {
            background: #dc2626;
        }

        .btn.danger:hover {
            background: #b91c1c;
        }

        .logs {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            max-height: 400px;
            overflow-y: auto;
        }

        .logs h3 {
            color: #2d3748;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .log-entry {
            padding: 8px 12px;
            margin-bottom: 8px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border-left: 3px solid #4299e1;
            background: rgba(66, 153, 225, 0.05);
        }

        .log-entry.error {
            border-left-color: #f56565;
            background: rgba(245, 101, 101, 0.05);
            color: #e53e3e;
        }

        .log-entry.success {
            border-left-color: #48bb78;
            background: rgba(72, 187, 120, 0.05);
            color: #38a169;
        }

        .log-entry.warning {
            border-left-color: #ed8936;
            background: rgba(237, 137, 54, 0.05);
            color: #dd6b20;
        }

        .connection-status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 15px;
            border-radius: 25px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .connection-status.connected {
            background: #48bb78;
            color: white;
        }

        .connection-status.disconnected {
            background: #f56565;
            color: white;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #718096;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(102, 126, 234, 0.2);
            border-radius: 50%;
            border-top-color: #667eea;
            border-right-color: #764ba2;
            animation: spin 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            margin-bottom: 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }

        /* ê³ ê¸‰ ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading-pulse {
            animation: pulse-glow 2s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
                box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
            }
            50% { 
                opacity: 0.7; 
                transform: scale(1.05);
                box-shadow: 0 0 40px rgba(102, 126, 234, 0.6);
            }
        }

        /* ë°ì´í„° ì¹´ë“œ ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ */
        .symbol-card {
            animation: slideInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            opacity: 0;
            transform: translateY(30px);
        }

        @keyframes slideInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .status-bar {
                grid-template-columns: 1fr;
            }
            
            .data-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="connection-status connected pulse" id="connectionStatus">
        <i class="fas fa-wifi"></i> ì—°ê²°ë¨
    </div>

    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> MoneyParadise ì‹¤ì‹œê°„ ë°ì´í„° ëŒ€ì‹œë³´ë“œ</h1>
            <p>ìŠ¤ë§ˆíŠ¸ ë°ì´í„° ìˆ˜ì§‘ - ì˜¨ë””ë§¨ë“œ ê²€ìƒ‰ ë° íš¨ìœ¨ì  ëª¨ë‹ˆí„°ë§</p>
        </div>

        <div class="status-bar" id="statusBar">
            <div class="status-card">
                <div class="icon" style="color: #2563eb;">
                    <i class="fas fa-server"></i>
                </div>
                <div class="title">ì‹œìŠ¤í…œ ìƒíƒœ</div>
                <div class="value" id="systemStatus">ì—°ê²° ì¤‘...</div>
                <div class="subtitle" id="lastUpdate">ìµœì¢… ì—…ë°ì´íŠ¸: ì—†ìŒ</div>
            </div>

            <div class="status-card">
                <div class="icon" style="color: #059669;">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <div class="title">í™œì„± ì‹¬ë³¼</div>
                <div class="value" id="activeSymbols">0</div>
                <div class="subtitle">ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì‹ </div>
            </div>

            <div class="status-card">
                <div class="icon" style="color: #dc2626;">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="title">ì‹œì¥ ìƒíƒœ</div>
                <div class="value" id="marketStatus">í™•ì¸ ì¤‘...</div>
                <div class="subtitle" id="marketTime">ì‹œì¥ ì‹œê°„ ê³„ì‚° ì¤‘</div>
            </div>
        </div>

        <div class="controls">
            <h3><i class="fas fa-cogs"></i> ì‹œìŠ¤í…œ ì œì–´</h3>
            <div class="control-buttons">
                <button class="btn" onclick="refreshSmartData()">
                    <i class="fas fa-sync-alt"></i> ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                </button>
                <button class="btn" onclick="collectMarketOpen()">
                    <i class="fas fa-sun"></i> ê°œì¥ ë°ì´í„° ìˆ˜ì§‘
                </button>
                <button class="btn" onclick="collectMarketClose()">
                    <i class="fas fa-moon"></i> íì¥ ë°ì´í„° ìˆ˜ì§‘
                </button>
                <button class="btn secondary" onclick="addWatchedSymbol()">
                    <i class="fas fa-eye"></i> ê´€ì‹¬ í‹°ì»¤ ì¶”ê°€
                </button>
                <button class="btn danger" onclick="clearLogs()">
                    <i class="fas fa-trash"></i> ë¡œê·¸ ì‚­ì œ
                </button>
            </div>
        </div>

        <!-- í‹°ì»¤ ê²€ìƒ‰ ì„¹ì…˜ -->
        <div class="controls">
            <h3><i class="fas fa-search"></i> í‹°ì»¤ ê²€ìƒ‰</h3>
            <div style="position: relative;">
                <input type="text" id="symbolInput" placeholder="í‹°ì»¤ ë˜ëŠ” íšŒì‚¬ëª… ì…ë ¥ (ì˜ˆ: TSLA, í…ŒìŠ¬ë¼, Apple)" 
                       style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1em; box-sizing: border-box;"
                       onkeyup="handleSymbolInput(event)" onfocus="showSuggestions()" onblur="hideSuggestions()">
                
                <!-- ìë™ì™„ì„± ë“œë¡­ë‹¤ìš´ -->
                <div id="suggestions" style="position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #e2e8f0; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 1000; display: none; max-height: 200px; overflow-y: auto;">
                </div>
            </div>
            <div style="margin-top: 10px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <button class="btn" onclick="searchSymbolInput()">
                    <i class="fas fa-search"></i> ê²€ìƒ‰
                </button>
                <div style="font-size: 0.9em; color: #6b7280;">
                    ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ì˜¨ë””ë§¨ë“œë¡œ ìˆ˜ì§‘í•©ë‹ˆë‹¤
                </div>
            </div>
        </div>

        <!-- TradingView ìŠ¤íƒ€ì¼ ì°¨íŠ¸ ì¸í„°í˜ì´ìŠ¤ -->
        <div class="chart-container" id="chartContainer" style="display: none;">
            <!-- ì°¨íŠ¸ í—¤ë” -->
            <div class="chart-header">
                <div class="symbol-info">
                    <h2 id="chartSymbol">TSLA</h2>
                    <span class="market-info" id="marketInfo">NASDAQ â€¢ ì‹¤ì‹œê°„</span>
                </div>
                <div class="price-info">
                    <div class="current-price">
                        <span class="price" id="currentPrice">$440.86</span>
                        <span class="change" id="priceChange">+2.34 (+0.53%)</span>
                    </div>
                    <div class="price-details">
                        <div class="price-item">
                            <span class="label">ê³ ê°€:</span>
                            <span class="value" id="highPrice">$442.50</span>
                        </div>
                        <div class="price-item">
                            <span class="label">ì €ê°€:</span>
                            <span class="value" id="lowPrice">$438.20</span>
                        </div>
                        <div class="price-item">
                            <span class="label">ê±°ë˜ëŸ‰:</span>
                            <span class="value" id="volume">45.2M</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì°¨íŠ¸ ë©”ì¸ ì˜ì—­ -->
            <div class="chart-main">
                <div class="chart-area" id="chartArea">
                    <!-- ìº”ë“¤ìŠ¤í‹± ì°¨íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    <!-- TradingView ìœ„ì ¯ -->
                    <div id="tradingview_widget" style="width: 100%; height: 100%;"></div>
                </div>
                
                <!-- ì°¨íŠ¸ ì»¨íŠ¸ë¡¤ -->
                <div class="chart-controls">
                    <div class="timeframe-selector">
                        <button class="timeframe-btn active" data-timeframe="1m">1ë¶„</button>
                        <button class="timeframe-btn" data-timeframe="5m">5ë¶„</button>
                        <button class="timeframe-btn" data-timeframe="15m">15ë¶„</button>
                        <button class="timeframe-btn" data-timeframe="1h">1ì‹œê°„</button>
                        <button class="timeframe-btn" data-timeframe="1d">1ì¼</button>
                    </div>
                    <div class="chart-tools">
                        <button class="tool-btn" title="ì§€í‘œ ì¶”ê°€"><i class="fas fa-plus"></i></button>
                        <button class="tool-btn" title="ì¶”ì„¸ì„ "><i class="fas fa-chart-line"></i></button>
                        <button class="tool-btn" title="í”¼ë³´ë‚˜ì¹˜"><i class="fas fa-ruler"></i></button>
                        <button class="tool-btn" title="ì„¤ì •"><i class="fas fa-cog"></i></button>
                    </div>
                </div>
            </div>

            <!-- ê¸°ìˆ ì  ì§€í‘œ íŒ¨ë„ -->
            <div class="indicators-panel">
                <h4>ê¸°ìˆ ì  ì§€í‘œ</h4>
                <div class="indicators-grid" id="indicatorsGrid">
                    <div class="indicator-item">
                        <div class="indicator-label">RSI (14)</div>
                        <div class="indicator-value" id="rsiValue">52.3</div>
                        <div class="indicator-status neutral">ì¤‘ë¦½</div>
                    </div>
                    <div class="indicator-item">
                        <div class="indicator-label">MACD</div>
                        <div class="indicator-value" id="macdValue">+1.23</div>
                        <div class="indicator-status bullish">ìƒìŠ¹</div>
                    </div>
                    <div class="indicator-item">
                        <div class="indicator-label">ë³¼ë¦°ì € ë°´ë“œ</div>
                        <div class="indicator-value" id="bbValue">ìƒë‹¨ ê·¼ì ‘</div>
                        <div class="indicator-status warning">ì£¼ì˜</div>
                    </div>
                    <div class="indicator-item">
                        <div class="indicator-label">ì´ë™í‰ê· </div>
                        <div class="indicator-value" id="maValue">ìƒìŠ¹ ì¶”ì„¸</div>
                        <div class="indicator-status bullish">ìƒìŠ¹</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê¸°ë³¸ ë°ì´í„° ê·¸ë¦¬ë“œ (ì°¨íŠ¸ê°€ ì—†ì„ ë•Œ í‘œì‹œ) -->
        <div class="data-grid" id="dataGrid">
            <div class="loading">
                <div class="spinner"></div>
                <p>ë°ì´í„° ë¡œë”© ì¤‘...</p>
                <div class="loading-message">
                    <p>ğŸ’¡ <strong>íŒ:</strong> ê²€ìƒ‰ì°½ì— í‹°ì»¤ë¥¼ ì…ë ¥í•˜ë©´ ì „ë¬¸ì ì¸ ì°¨íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤!</p>
                </div>
            </div>
        </div>

        <div class="logs">
            <h3><i class="fas fa-terminal"></i> ì‹¤ì‹œê°„ ì‹œìŠ¤í…œ ë¡œê·¸</h3>
            <div id="logContainer">
                <div class="log-entry">
                    MoneyParadise í„°ë³´ ë°ì´í„° í”„ë¡œë°”ì´ë” ì´ˆê¸°í™” ì™„ë£Œ
                </div>
            </div>
        </div>
    </div>

    <script>
        let updateInterval = null;
        let isAutoRefresh = true;
        let lastData = {};

        // API ê¸°ë³¸ URL
        const API_BASE = 'http://localhost:3001/api/v1';
        
        // ìŠ¤ë§ˆíŠ¸ ë°ì´í„° ì‹œìŠ¤í…œ ë³€ìˆ˜
        let smartData = {};
        let marketStatus = {};

        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            logMessage('ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹œì‘', 'success');
            initializeSystem();
            startAutoRefresh();
        });

        // ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        async function initializeSystem() {
            try {
                updateConnectionStatus(true);
                await refreshSmartData();
                await updateSystemStatus();
                logMessage('ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ', 'success');
            } catch (error) {
                logMessage(`ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`, 'error');
                updateConnectionStatus(false);
            }
        }

        // ğŸ§  ìŠ¤ë§ˆíŠ¸ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
        async function refreshSmartData() {
            try {
                updateConnectionStatus(true);
                console.log('ğŸ”„ ìŠ¤ë§ˆíŠ¸ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘...');
                
                const response = await fetch(`${API_BASE}/smart-data`);
                const data = await response.json();
                
                console.log('ğŸ“¥ API ì‘ë‹µ ë°ì´í„°:', data);
                
                if (data.error) {
                    throw new Error(data.message);
                }

                smartData = data.smartData || {};
                marketStatus = data.smartStatus || {};
                
                console.log('ğŸ“Š íŒŒì‹±ëœ ìŠ¤ë§ˆíŠ¸ ë°ì´í„°:', smartData);
                console.log('ğŸ“ˆ íŒŒì‹±ëœ ë§ˆì¼“ ìƒíƒœ:', marketStatus);
                
                updateDataGrid(smartData);
                updateSmartStatus(marketStatus);
                updateLastUpdateTime();
                
                const symbolCount = Object.keys(smartData).length;
                logMessage(`ë°ì´í„° ì—…ë°ì´íŠ¸: ${symbolCount}ê°œ ì‹¬ë³¼`, 'success');
                
                // ì„±ê³µ ì•Œë¦¼
                showNotification(`${symbolCount}ê°œ ì‹¬ë³¼ ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ`, 'success', 3000);
                
            } catch (error) {
                console.error('âŒ ìŠ¤ë§ˆíŠ¸ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);
                logMessage(`ìŠ¤ë§ˆíŠ¸ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨: ${error.message}`, 'error');
                updateConnectionStatus(false);
                showNotification('ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨', 'error', 5000);
            }
        }

        // ì‹œìŠ¤í…œ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateSmartStatus(status) {
            console.log('ğŸ“Š ìŠ¤ë§ˆíŠ¸ ìƒíƒœ ì—…ë°ì´íŠ¸:', status);
            
            // í™œì„± ì‹¬ë³¼ ìˆ˜ - ì‹¤ì œ ë°ì´í„° êµ¬ì¡°ì— ë§ê²Œ ìˆ˜ì •
            const activeCount = status.cachedSymbols || 0;
            document.getElementById('activeSymbols').textContent = activeCount;
            console.log(`âœ… í™œì„± ì‹¬ë³¼ ìˆ˜: ${activeCount}`);
            
            // ì‹œì¥ ìƒíƒœ
            const marketInfo = status.marketStatus || {};
            const isMarketOpen = marketInfo.isOpen;
            document.getElementById('marketStatus').textContent = isMarketOpen ? 'ê±°ë˜ ì¤‘' : 'íì¥';
            document.getElementById('marketStatus').style.color = isMarketOpen ? '#059669' : '#dc2626';
            
            // ì‹œì¥ ì‹œê°„
            const nextOpen = marketInfo.nextOpenTime;
            const nextClose = marketInfo.nextCloseTime;
            if (nextOpen) {
                const openTime = new Date(nextOpen).toLocaleString();
                document.getElementById('marketTime').textContent = isMarketOpen ? 
                    `íì¥: ${new Date(nextClose).toLocaleTimeString()}` : 
                    `ê°œì¥: ${openTime}`;
            }
            
            // ì‚¬ìš©ì ê²€ìƒ‰í•œ ì‹¬ë³¼ í‘œì‹œ
            const userSearched = status.userSearchedSymbols || [];
            if (userSearched.length > 0) {
                console.log(`ğŸ” ì‚¬ìš©ì ê²€ìƒ‰ ì‹¬ë³¼: ${userSearched.join(', ')}`);
            }
        }

        // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
        async function refreshData() {
            try {
                updateConnectionStatus(true);
                
                const response = await fetch(`${API_BASE}/market-data`);
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.message);
                }

                updateDataGrid(data.cachedData || {});
                updateLastUpdateTime();
                
                logMessage(`${Object.keys(data.cachedData || {}).length}ê°œ ì‹¬ë³¼ ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ`, 'success');
                
            } catch (error) {
                logMessage(`ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨: ${error.message}`, 'error');
                updateConnectionStatus(false);
            }
        }

        // ì‹œìŠ¤í…œ ìƒíƒœ ì—…ë°ì´íŠ¸
        async function updateSystemStatus() {
            try {
                const response = await fetch(`${API_BASE}/status`);
                const data = await response.json();
                
                // í™œì„± ì‹¬ë³¼ ìˆ˜ ì—…ë°ì´íŠ¸
                const activeCount = Object.keys(lastData).length;
                document.getElementById('activeSymbols').textContent = activeCount;
                
                // ì‹œìŠ¤í…œ ìƒíƒœ ì—…ë°ì´íŠ¸
                if (data.status === 'healthy') {
                    document.getElementById('systemStatus').textContent = 'ì •ìƒ ìš´ì˜';
                    document.getElementById('systemStatus').style.color = '#48bb78';
                } else {
                    document.getElementById('systemStatus').textContent = 'ì ê²€ í•„ìš”';
                    document.getElementById('systemStatus').style.color = '#f56565';
                }

            } catch (error) {
                logMessage(`ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ë°ì´í„° ê·¸ë¦¬ë“œ ì—…ë°ì´íŠ¸ (ê³ ê¸‰ UX)
        function updateDataGrid(data) {
            lastData = data;
            
            const grid = document.getElementById('dataGrid');
            const symbols = Object.keys(data);
            
            if (symbols.length === 0) {
                grid.innerHTML = `
                    <div class="loading loading-pulse">
                        <div class="spinner"></div>
                        <p>ğŸ§  ìŠ¤ë§ˆíŠ¸ ë°ì´í„° ë¡œë”© ì¤‘...</p>
                        <small>ì˜¨ë””ë§¨ë“œ ìˆ˜ì§‘ìœ¼ë¡œ íš¨ìœ¨ì„± ê·¹ëŒ€í™”</small>
                    </div>
                `;
                return;
            }

            // ê¸°ì¡´ ì¹´ë“œë“¤ì„ ë¶€ë“œëŸ½ê²Œ ì œê±°
            const existingCards = grid.querySelectorAll('.symbol-card');
            existingCards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.animation = 'slideOut 0.3s ease forwards';
                    setTimeout(() => card.remove(), 300);
                }, index * 50);
            });

            // ìƒˆë¡œìš´ ì¹´ë“œë“¤ì„ ìˆœì°¨ì ìœ¼ë¡œ ì¶”ê°€
            setTimeout(() => {
                grid.innerHTML = symbols.map((symbol, index) => {
                    setTimeout(() => {
                        const cardElement = document.createElement('div');
                        cardElement.innerHTML = createSymbolCardHTML(symbol, data[symbol]);
                        cardElement.className = 'symbol-card';
                        cardElement.style.animationDelay = `${index * 100}ms`;
                        grid.appendChild(cardElement);
                    }, index * 100);
                    
                    return createSymbolCardHTML(symbol, data[symbol]);
                }).join('');
            }, existingCards.length * 50);
        }

        // ì‹¬ë³¼ ì¹´ë“œ HTML ìƒì„± í•¨ìˆ˜
        function createSymbolCardHTML(symbol, item) {
                const change = item.change || 0;
                const changeClass = change > 0 ? 'up' : change < 0 ? 'down' : 'neutral';
            const changeIcon = change > 0 ? 'ğŸ“ˆ' : change < 0 ? 'ğŸ“‰' : 'â¡ï¸';
                
                return `
                <div class="symbol-card ${changeClass}" style="animation-delay: 0ms;">
                        <div class="symbol-header">
                        <div class="symbol-name">
                            ${symbol}
                            <span style="font-size: 0.8em; margin-left: 8px;">${changeIcon}</span>
                        </div>
                        <div class="symbol-source">
                            ${item.source || 'ì•Œ ìˆ˜ ì—†ìŒ'}
                            ${item.collectionType ? `<br><small>${item.collectionType}</small>` : ''}
                        </div>
                        </div>
                        
                        <div class="price-info">
                            <div class="price-main">
                                <div class="current-price">$${formatPrice(item.currentPrice)}</div>
                                <div class="change-info">
                                    <div class="change ${changeClass}">
                                        ${change > 0 ? '+' : ''}${formatPrice(change)}
                                    </div>
                                    <div class="change-percent">
                                        ${item.changePercent ? formatPercent(item.changePercent) : 'N/A'}%
                                    </div>
                                </div>
                            </div>
                            
                            <div class="price-details">
                                <div class="price-item">ì‹œì´ˆ <span>$${formatPrice(item.open)}</span></div>
                                <div class="price-item">ê³ ê°€ <span>$${formatPrice(item.high)}</span></div>
                                <div class="price-item">ì €ê°€ <span>$${formatPrice(item.low)}</span></div>
                                <div class="price-item">ê±°ë˜ëŸ‰ <span>${formatVolume(item.volume)}</span></div>
                            </div>
                        </div>
                        
                        <div class="update-time">
                        ${item.cached ? 'ğŸ’¾ ìºì‹œëœ ë°ì´í„°' : ''}
                            ${item.lastRefreshed ? 'ì—…ë°ì´íŠ¸: ' + formatTime(item.lastRefreshed) : ''}
                        ${item.cacheAge ? ` (${Math.round(item.cacheAge / 1000)}ì´ˆ ì „)` : ''}
                        </div>
                    </div>
                `;
        }

        // ìë™ ìƒˆë¡œê³ ì¹¨ ì‹œì‘
        function startAutoRefresh() {
            if (updateInterval) return;
            
            isAutoRefresh = true;
            updateInterval = setInterval(() => {
                if (isAutoRefresh) {
                    refreshData();
                    updateSystemStatus();
                }
            }, 5000); // 5ì´ˆë§ˆë‹¤ ìƒˆë¡œê³ ì¹¨
            
            logMessage('ìë™ ìƒˆë¡œê³ ì¹¨ ì‹œì‘ (5ì´ˆ ê°„ê²©)', 'success');
        }

        // ìë™ ìƒˆë¡œê³ ì¹¨ ì¤‘ë‹¨
        function stopAutoRefresh() {
            if (updateInterval) {
                clearInterval(updateInterval);
                updateInterval = null;
                isAutoRefresh = false;
                logMessage('ìë™ ìƒˆë¡œê³ ì¹¨ ì¤‘ë‹¨', 'warning');
            }
        }

        // ğŸ“¢ ë°˜ì‘í˜• í”¼ë“œë°± ì‹œìŠ¤í…œ
        function showNotification(message, type = 'info', duration = 3000) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center;">
                    <span class="status-indicator ${type}"></span>
                    <span style="font-weight: 500;">${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ í‘œì‹œ
            setTimeout(() => notification.classList.add('show'), 100);
            
            // ìë™ ì œê±°
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, duration);
        }

        function updateButtonState(buttonSelector, state, text) {
            const button = document.querySelector(buttonSelector);
            if (button) {
                button.disabled = state === 'loading';
                button.className = button.className.replace(/loading/g, '');
                if (state === 'loading') button.className += ' loading';
                button.innerHTML = text;
            }
        }

        function updateConnectionStatus(isConnected) {
            const statusElement = document.getElementById('systemStatus');
            if (statusElement) {
                if (isConnected) {
                    statusElement.innerHTML = '<span class="status-indicator success"></span>ì—°ê²°ë¨';
                    statusElement.style.color = '#059669';
                } else {
                    statusElement.innerHTML = '<span class="status-indicator error"></span>ì—°ê²° ëŠê¹€';
                    statusElement.style.color = '#dc2626';
                }
            }
        }

        // ğŸ” ì˜¨ë””ë§¨ë“œ í‹°ì»¤ ê²€ìƒ‰ (í•œêµ­ì–´ ì§€ì› + ë°˜ì‘í˜• í”¼ë“œë°±)
        async function searchSymbolInput() {
            const symbolInput = document.getElementById('symbolInput');
            let symbol = symbolInput.value.trim();
            
            if (!symbol) {
                logMessage('í‹°ì»¤ ì‹¬ë³¼ ë˜ëŠ” íšŒì‚¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”', 'warning');
                return;
            }

            // ë°˜ì‘í˜• í”¼ë“œë°± ì‹œì‘
            updateButtonState('button[onclick="searchSymbolInput()"]', 'loading', '<i class="fas fa-spinner fa-spin"></i> ê²€ìƒ‰ ì¤‘...');
            showNotification('ê²€ìƒ‰ì„ ì‹œì‘í•©ë‹ˆë‹¤...', 'info', 2000);

            // í•œêµ­ì–´ ë˜ëŠ” ì˜ì–´ íšŒì‚¬ëª…ìœ¼ë¡œ ê²€ìƒ‰ëœ ê²½ìš° í‹°ì»¤ ì‹¬ë³¼ë¡œ ë³€í™˜
            const foundStock = popularStocks.find(stock => 
                stock.symbol.toUpperCase() === symbol.toUpperCase() || 
                stock.name.toUpperCase().includes(symbol.toUpperCase()) ||
                stock.korean.includes(symbol)
            );
            
            if (foundStock) {
                symbol = foundStock.symbol;
                symbolInput.value = symbol; // ì…ë ¥ì°½ì— ì •í™•í•œ í‹°ì»¤ í‘œì‹œ
                logMessage(`ğŸ” ${symbol} (${foundStock.korean}) ê²€ìƒ‰ ì‹œì‘...`, 'info');
                showNotification(`${foundStock.korean} (${symbol}) ê²€ìƒ‰ ì¤‘...`, 'info', 2000);
            } else {
                symbol = symbol.toUpperCase(); // ì…ë ¥ê°’ì„ ëŒ€ë¬¸ìë¡œ ë³€í™˜
                logMessage(`ğŸ” ${symbol} ê²€ìƒ‰ ì‹œì‘...`, 'info');
                showNotification(`${symbol} ê²€ìƒ‰ ì¤‘...`, 'info', 2000);
            }
            
            try {
                await searchOnDemandSymbol(symbol);
            } finally {
                // ê²€ìƒ‰ ë²„íŠ¼ ë‹¤ì‹œ í™œì„±í™”
                updateButtonState('button[onclick="searchSymbolInput()"]', 'normal', '<i class="fas fa-search"></i> ê²€ìƒ‰');
            }
        }

        // ğŸ“‹ ì¸ê¸° ì£¼ì‹ ë°ì´í„°ë² ì´ìŠ¤
        const popularStocks = [
            { symbol: 'AAPL', name: 'Apple Inc.', korean: 'ì• í”Œ' },
            { symbol: 'MSFT', name: 'Microsoft Corporation', korean: 'ë§ˆì´í¬ë¡œì†Œí”„íŠ¸' },
            { symbol: 'GOOGL', name: 'Alphabet Inc.', korean: 'êµ¬ê¸€' },
            { symbol: 'AMZN', name: 'Amazon.com Inc.', korean: 'ì•„ë§ˆì¡´' },
            { symbol: 'TSLA', name: 'Tesla Inc.', korean: 'í…ŒìŠ¬ë¼' },
            { symbol: 'META', name: 'Meta Platforms Inc.', korean: 'ë©”íƒ€' },
            { symbol: 'NVDA', name: 'NVIDIA Corporation', korean: 'ì—”ë¹„ë””ì•„' },
            { symbol: 'AMD', name: 'Advanced Micro Devices', korean: 'AMD' },
            { symbol: 'NFLX', name: 'Netflix Inc.', korean: 'ë„·í”Œë¦­ìŠ¤' },
            { symbol: 'INTC', name: 'Intel Corporation', korean: 'ì¸í…”' },
            { symbol: 'CRM', name: 'Salesforce Inc.', korean: 'ì„¸ì¼ì¦ˆí¬ìŠ¤' },
            { symbol: 'ADBE', name: 'Adobe Inc.', korean: 'ì–´ë„ë¹„' },
            { symbol: 'PYPL', name: 'PayPal Holdings Inc.', korean: 'í˜ì´íŒ”' },
            { symbol: 'UBER', name: 'Uber Technologies Inc.', korean: 'ìš°ë²„' },
            { symbol: 'SPOT', name: 'Spotify Technology S.A.', korean: 'ìŠ¤í¬í‹°íŒŒì´' },
            { symbol: 'SNAP', name: 'Snap Inc.', korean: 'ìŠ¤ëƒ…' },
            { symbol: 'TWTR', name: 'Twitter Inc.', korean: 'íŠ¸ìœ„í„°' },
            { symbol: 'SQ', name: 'Block Inc.', korean: 'ë¸”ë¡' },
            { symbol: 'ROKU', name: 'Roku Inc.', korean: 'ë¡œì¿ ' },
            { symbol: 'ZM', name: 'Zoom Video Communications', korean: 'ì¤Œ' }
        ];

        // ğŸ” ìë™ì™„ì„± ê¸°ëŠ¥ (í•œêµ­ì–´ ì§€ì› ê°•í™”)
        function handleSymbolInput(event) {
            const input = event.target.value.trim();
            const suggestionsDiv = document.getElementById('suggestions');
            
            if (input.length < 1) {
                suggestionsDiv.style.display = 'none';
                return;
            }

            // ê²€ìƒ‰ì–´ì™€ ë§¤ì¹­ë˜ëŠ” ì£¼ì‹ ì°¾ê¸° (í•œêµ­ì–´, ì˜ì–´ ëª¨ë‘ ì§€ì›)
            const matches = popularStocks.filter(stock => 
                stock.symbol.toUpperCase().includes(input.toUpperCase()) || 
                stock.name.toUpperCase().includes(input.toUpperCase()) ||
                stock.korean.includes(input) ||
                stock.korean.includes(input.toUpperCase()) // ëŒ€ì†Œë¬¸ì ë¬´ê´€ í•œêµ­ì–´ ê²€ìƒ‰
            );

            if (matches.length > 0) {
                // ìµœëŒ€ 8ê°œê¹Œì§€ë§Œ í‘œì‹œ
                const limitedMatches = matches.slice(0, 8);
                
                suggestionsDiv.innerHTML = limitedMatches.map(stock => {
                    // ê²€ìƒ‰ì–´ í•˜ì´ë¼ì´íŠ¸ í•¨ìˆ˜
                    const highlightText = (text, searchTerm) => {
                        if (!searchTerm) return text;
                        const regex = new RegExp(`(${searchTerm})`, 'gi');
                        return text.replace(regex, '<mark style="background-color: #fef3c7; color: #92400e;">$1</mark>');
                    };

                    return `<div class="suggestion-item" onclick="selectSuggestion('${stock.symbol}')" 
                             style="padding: 12px; cursor: pointer; border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center; transition: background-color 0.2s;"
                             onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='white'">
                        <div>
                            <div style="font-weight: bold; color: #2563eb;">${highlightText(stock.symbol, input)}</div>
                            <div style="font-size: 0.9em; color: #6b7280;">${highlightText(stock.name, input)}</div>
                        </div>
                        <div style="font-size: 0.8em; color: #9ca3af;">${highlightText(stock.korean, input)}</div>
                    </div>`;
                }).join('');
                
                suggestionsDiv.style.display = 'block';
            } else {
                suggestionsDiv.style.display = 'none';
            }
        }

        // ğŸ¯ ìë™ì™„ì„± ì„ íƒ
        function selectSuggestion(symbol) {
            document.getElementById('symbolInput').value = symbol;
            document.getElementById('suggestions').style.display = 'none';
            searchSymbolInput(); // ìë™ìœ¼ë¡œ ê²€ìƒ‰ ì‹¤í–‰
        }

        // ğŸ‘ï¸ ìë™ì™„ì„± í‘œì‹œ/ìˆ¨ê¹€
        function showSuggestions() {
            const input = document.getElementById('symbolInput').value.trim();
            if (input.length >= 1) {
                handleSymbolInput({ target: document.getElementById('symbolInput') });
            }
        }

        function hideSuggestions() {
            // ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ì–´ í´ë¦­ ì´ë²¤íŠ¸ê°€ ë¨¼ì € ì‹¤í–‰ë˜ë„ë¡
            setTimeout(() => {
                document.getElementById('suggestions').style.display = 'none';
            }, 200);
        }

        // ğŸ” ì˜¨ë””ë§¨ë“œ ì‹¬ë³¼ ê²€ìƒ‰ (ë°˜ì‘í˜• í”¼ë“œë°± ì ìš©)
        async function searchOnDemandSymbol(symbol) {
            try {
                logMessage(`${symbol} ê²€ìƒ‰ ì‹œì‘...`, 'info');
                
                // ë°˜ì‘í˜• ë¡œë”© ìƒíƒœ í‘œì‹œ
                document.getElementById('chartContainer').innerHTML = `
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>${symbol} ë°ì´í„° ë¡œë”© ì¤‘...</p>
                        <div class="progress-bar">
                            <div class="progress-fill" id="searchProgress"></div>
                        </div>
                    </div>
                `;
                
                // ì§„í–‰ë¥  ì• ë‹ˆë©”ì´ì…˜
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += Math.random() * 20;
                    if (progress > 90) progress = 90;
                    const progressBar = document.getElementById('searchProgress');
                    if (progressBar) progressBar.style.width = progress + '%';
                }, 200);
                
                showNotification(`${symbol} ì„œë²„ì—ì„œ ë°ì´í„° ìš”ì²­ ì¤‘...`, 'info', 2000);
                
                const response = await fetch(`${API_BASE}/smart-data/${symbol}`);
                const data = await response.json();
                
                clearInterval(progressInterval);
                
                if (data.error) {
                    throw new Error(data.message);
                }
                
                logMessage(`âœ… ${symbol} ê²€ìƒ‰ ì„±ê³µ (${data.source})`, 'success');
                showNotification(`${symbol} ë°ì´í„° ìˆ˜ì§‘ ì„±ê³µ!`, 'success', 3000);
                
                // TradingView ìŠ¤íƒ€ì¼ ì°¨íŠ¸ ì¸í„°í˜ì´ìŠ¤ í‘œì‹œ
                if (data.data) {
                    const symbolData = data.data;
                    logMessage(`ğŸ“Š ${symbol} ë°ì´í„° íŒŒì‹± ì¤‘...`, 'info');
                    
                    // ì§„í–‰ë¥  100% ì™„ë£Œ
                    const progressBar = document.getElementById('searchProgress');
                    if (progressBar) progressBar.style.width = '100%';
                    
                    setTimeout(() => {
                        // ê¸°ë³¸ ë°ì´í„° ê·¸ë¦¬ë“œ ìˆ¨ê¸°ê³  ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ í‘œì‹œ
                        document.getElementById('dataGrid').style.display = 'none';
                        document.getElementById('chartContainer').style.display = 'block';
                        
                        // ì°¨íŠ¸ ë°ì´í„° ì—…ë°ì´íŠ¸
                        updateChartInterface(symbolData);
                        
                        const price = symbolData.currentPrice?.toFixed(2) || 'N/A';
                        const change = symbolData.changePercent ? (symbolData.changePercent > 0 ? '+' : '') + symbolData.changePercent.toFixed(2) + '%' : 'N/A';
                        
                        logMessage(`ğŸ¯ ${symbol} ì „ë¬¸ ì°¨íŠ¸ í‘œì‹œ ì™„ë£Œ! ê°€ê²©: $${price}, ë³€ë™: ${change}`, 'success');
                        showNotification(`${symbol}: $${price} (${change}) - ì „ë¬¸ ì°¨íŠ¸ í™œì„±í™”`, 'success', 4000);
                    }, 500);
                    
                } else {
                    logMessage(`âŒ ${symbol} ì‘ë‹µ ë°ì´í„°ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤`, 'error');
                    throw new Error('ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }
                
            } catch (error) {
                logMessage(`${symbol} ê²€ìƒ‰ ì‹¤íŒ¨: ${error.message}`, 'error');
                showNotification(`${symbol} ê²€ìƒ‰ ì‹¤íŒ¨: ${error.message}`, 'error', 5000);
                
                document.getElementById('dataGrid').innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #dc2626;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 3em; margin-bottom: 20px;"></i>
                        <h3>ê²€ìƒ‰ ì‹¤íŒ¨</h3>
                        <p>${symbol} ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                        <button class="btn" onclick="refreshSmartData()" style="margin-top: 20px;">
                            <i class="fas fa-refresh"></i> ë‹¤ì‹œ ì‹œë„
                        </button>
                    </div>
                `;
            }
        }

        // ğŸ“Š ì°¨íŠ¸ ì¸í„°í˜ì´ìŠ¤ ì—…ë°ì´íŠ¸
        function updateChartInterface(symbolData) {
            try {
                // ê¸°ë³¸ ì •ë³´ ì—…ë°ì´íŠ¸
                document.getElementById('chartSymbol').textContent = symbolData.symbol;
                document.getElementById('marketInfo').textContent = 'NASDAQ â€¢ ì‹¤ì‹œê°„';
                
                // ê°€ê²© ì •ë³´ ì—…ë°ì´íŠ¸
                const currentPrice = symbolData.currentPrice?.toFixed(2) || 'N/A';
                document.getElementById('currentPrice').textContent = `$${currentPrice}`;
                
                // ë³€ë™ë¥  ê³„ì‚° ë° í‘œì‹œ
                const change = symbolData.change || 0;
                const changePercent = symbolData.changePercent || 0;
                const changeElement = document.getElementById('priceChange');
                
                if (change > 0) {
                    changeElement.textContent = `+${change.toFixed(2)} (+${changePercent.toFixed(2)}%)`;
                    changeElement.className = 'change positive';
                } else if (change < 0) {
                    changeElement.textContent = `${change.toFixed(2)} (${changePercent.toFixed(2)}%)`;
                    changeElement.className = 'change negative';
                } else {
                    changeElement.textContent = `${change.toFixed(2)} (${changePercent.toFixed(2)}%)`;
                    changeElement.className = 'change neutral';
                }
                
                // ìƒì„¸ ê°€ê²© ì •ë³´ ì—…ë°ì´íŠ¸
                document.getElementById('highPrice').textContent = `$${(symbolData.high || symbolData.currentPrice || 0).toFixed(2)}`;
                document.getElementById('lowPrice').textContent = `$${(symbolData.low || symbolData.currentPrice || 0).toFixed(2)}`;
                
                // ê±°ë˜ëŸ‰ í¬ë§·íŒ…
                const volume = symbolData.volume || 0;
                let volumeText = 'N/A';
                if (volume > 0) {
                    if (volume >= 1000000000) {
                        volumeText = `${(volume / 1000000000).toFixed(1)}B`;
                    } else if (volume >= 1000000) {
                        volumeText = `${(volume / 1000000).toFixed(1)}M`;
                    } else if (volume >= 1000) {
                        volumeText = `${(volume / 1000).toFixed(1)}K`;
                    } else {
                        volumeText = volume.toLocaleString();
                    }
                }
                document.getElementById('volume').textContent = volumeText;
                
                // ê¸°ìˆ ì  ì§€í‘œ ì—…ë°ì´íŠ¸ (ì‹¤ì œ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ëª¨ì˜ ë°ì´í„°)
                // TradingView ì°¨íŠ¸ ìƒì„± (ì„ì‹œ ì£¼ì„ ì²˜ë¦¬)
                // createTradingViewChart(symbolData);
                
                updateTechnicalIndicators(symbolData);
                
                logMessage(`ğŸ“ˆ ${symbolData.symbol} ì°¨íŠ¸ ì¸í„°í˜ì´ìŠ¤ ì—…ë°ì´íŠ¸ ì™„ë£Œ`, 'info');
                
            } catch (error) {
                logMessage(`âŒ ì°¨íŠ¸ ì¸í„°í˜ì´ìŠ¤ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ğŸ“Š ê¸°ìˆ ì  ì§€í‘œ ì—…ë°ì´íŠ¸
        function updateTechnicalIndicators(symbolData) {
            try {
                // RSI ê³„ì‚° (ê°„ë‹¨í•œ ëª¨ì˜ ê³„ì‚°)
                const rsi = calculateMockRSI(symbolData);
                document.getElementById('rsiValue').textContent = rsi.toFixed(1);
                const rsiStatus = rsi > 70 ? 'bearish' : rsi < 30 ? 'bullish' : 'neutral';
                document.querySelector('#rsiValue').nextElementSibling.className = `indicator-status ${rsiStatus}`;
                document.querySelector('#rsiValue').nextElementSibling.textContent = rsi > 70 ? 'ê³¼ë§¤ìˆ˜' : rsi < 30 ? 'ê³¼ë§¤ë„' : 'ì¤‘ë¦½';
                
                // MACD ê³„ì‚° (ê°„ë‹¨í•œ ëª¨ì˜ ê³„ì‚°)
                const macd = calculateMockMACD(symbolData);
                document.getElementById('macdValue').textContent = macd > 0 ? `+${macd.toFixed(2)}` : macd.toFixed(2);
                const macdStatus = macd > 0 ? 'bullish' : 'bearish';
                document.querySelector('#macdValue').nextElementSibling.className = `indicator-status ${macdStatus}`;
                document.querySelector('#macdValue').nextElementSibling.textContent = macd > 0 ? 'ìƒìŠ¹' : 'í•˜ë½';
                
                // ë³¼ë¦°ì € ë°´ë“œ ìƒíƒœ (ëª¨ì˜ ê³„ì‚°)
                const bbStatus = calculateMockBBStatus(symbolData);
                document.getElementById('bbValue').textContent = bbStatus.text;
                document.querySelector('#bbValue').nextElementSibling.className = `indicator-status ${bbStatus.status}`;
                document.querySelector('#bbValue').nextElementSibling.textContent = bbStatus.label;
                
                // ì´ë™í‰ê·  ìƒíƒœ (ëª¨ì˜ ê³„ì‚°)
                const maStatus = calculateMockMAStatus(symbolData);
                document.getElementById('maValue').textContent = maStatus.text;
                document.querySelector('#maValue').nextElementSibling.className = `indicator-status ${maStatus.status}`;
                document.querySelector('#maValue').nextElementSibling.textContent = maStatus.label;
                
            } catch (error) {
                logMessage(`âŒ ê¸°ìˆ ì  ì§€í‘œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // TradingView ì°¨íŠ¸ ìƒì„±
        let tradingViewWidget = null;
        
        function createTradingViewChart(symbolData) {
            // ê¸°ì¡´ ìœ„ì ¯ ì œê±°
            if (tradingViewWidget) {
                tradingViewWidget.remove();
            }
            
            // TradingView ìœ„ì ¯ ìƒì„±
            tradingViewWidget = new TradingView.widget({
                "autosize": true,
                "symbol": `${symbolData.symbol}`,
                "interval": "1",
                "timezone": "Asia/Seoul",
                "theme": "light",
                "style": "1",
                "locale": "ko",
                "toolbar_bg": "#f1f3f6",
                "enable_publishing": false,
                "withdateranges": true,
                "hide_side_toolbar": false,
                "allow_symbol_change": true,
                "details": true,
                "hotlist": true,
                "calendar": true,
                "studies": [
                    "Volume@tv-basicstudies",
                    "RSI@tv-basicstudies", 
                    "MACD@tv-basicstudies",
                    "BB@tv-basicstudies",
                    "Stochastic@tv-basicstudies",
                    "Williams%R@tv-basicstudies",
                    "CCI@tv-basicstudies"
                ],
                "container_id": "tradingview_widget",
                "show_popup_button": true,
                "popup_width": "1000",
                "popup_height": "650",
                "no_referral_id": true,
                "referral_id": "your_referral_id", // ìœ ë£Œ ê³„ì •ì—ì„œ ìˆ˜ìµí™” ê°€ëŠ¥
                "disabled_features": [
                    "use_localstorage_for_settings",
                    "volume_force_overlay",
                    "create_volume_indicator_by_default"
                ],
                "enabled_features": [
                    "side_toolbar_in_fullscreen_mode",
                    "header_in_fullscreen_mode",
                    "use_localstorage_for_settings"
                ],
                "overrides": {
                    "paneProperties.background": "#ffffff",
                    "paneProperties.vertGridProperties.color": "#e1e3e6",
                    "paneProperties.horzGridProperties.color": "#e1e3e6",
                    "symbolWatermarkProperties.transparency": 90,
                    "scalesProperties.textColor": "#131722"
                },
                "studies_overrides": {
                    "volume.volume.color.0": "#00bcd4",
                    "volume.volume.color.1": "#0000ff",
                    "volume.volume.transparency": 70
                }
            });
            
            console.log(`ğŸ“Š TradingView ì°¨íŠ¸ ìƒì„± ì™„ë£Œ: ${symbolData.symbol}`);
        }
        
        async function createRealTimeChart(symbolData) {
            const ctx = document.getElementById('priceChart');
            if (!ctx) return;
            
            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            if (chartInstance) {
                chartInstance.destroy();
            }
            
            try {
                // ì‹¤ì œ ê³¼ê±° ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                console.log(`ğŸ“Š ${symbolData.symbol} ì‹¤ì œ ê³¼ê±° ë°ì´í„° ìš”ì²­ ì¤‘...`);
                
                const response = await fetch(`${API_BASE}/historical-data/${symbolData.symbol}?period=1mo&interval=1d`);
                const historicalResult = await response.json();
                
                if (!historicalResult.success) {
                    throw new Error(historicalResult.message || 'ê³¼ê±° ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨');
                }
                
                const historicalData = historicalResult.data.data;
                console.log(`âœ… ${symbolData.symbol} ê³¼ê±° ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ: ${historicalData.length}ê°œ ë°ì´í„° í¬ì¸íŠ¸`);
                
                // ì‹¤ì œ ë°ì´í„°ë¡œ ì°¨íŠ¸ ìƒì„±
                const labels = historicalData.map(item => {
                    const date = new Date(item.timestamp);
                    return date.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' });
                });
                
                const prices = historicalData.map(item => item.close);
            
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: symbolData.symbol,
                        data: prices,
                        borderColor: symbolData.change >= 0 ? '#059669' : '#dc2626',
                        backgroundColor: symbolData.change >= 0 ? 'rgba(5, 150, 105, 0.1)' : 'rgba(220, 38, 38, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: symbolData.change >= 0 ? '#059669' : '#dc2626',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#374151',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return '$' + context.parsed.y.toFixed(2);
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: {
                                color: 'rgba(156, 163, 175, 0.1)'
                            },
                            ticks: {
                                color: '#6b7280',
                                maxTicksLimit: 8
                            }
                        },
                        y: {
                            display: true,
                            grid: {
                                color: 'rgba(156, 163, 175, 0.1)'
                            },
                            ticks: {
                                color: '#6b7280',
                                callback: function(value) {
                                    return '$' + value.toFixed(0);
                                }
                            }
                        }
                    },
                    elements: {
                        point: {
                            hoverRadius: 6
                        }
                    }
                }
            });
            
            } catch (error) {
                console.error('ì°¨íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ë³¸ ë©”ì‹œì§€ í‘œì‹œ
                ctx.innerHTML = '<p style="text-align: center; color: #666; padding: 50px;">ì°¨íŠ¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>';
            }
        }
        
        // ğŸ“ˆ ëª¨ì˜ ê¸°ìˆ ì  ì§€í‘œ ê³„ì‚° í•¨ìˆ˜ë“¤
        function calculateMockRSI(symbolData) {
            // ê°„ë‹¨í•œ RSI ëª¨ì˜ ê³„ì‚° (ì‹¤ì œë¡œëŠ” ê³¼ê±° ë°ì´í„°ê°€ í•„ìš”)
            const price = symbolData.currentPrice || 0;
            const volatility = Math.random() * 20 + 30; // 30-50 ì‚¬ì´ì˜ ëœë¤ ê°’
            return volatility;
        }

        function calculateMockMACD(symbolData) {
            // ê°„ë‹¨í•œ MACD ëª¨ì˜ ê³„ì‚°
            const price = symbolData.currentPrice || 0;
            const trend = (price % 100) / 100 - 0.5; // -0.5 ~ 0.5 ì‚¬ì´ì˜ íŠ¸ë Œë“œ
            return trend * 5; // -2.5 ~ 2.5 ì‚¬ì´ì˜ ê°’
        }

        function calculateMockBBStatus(symbolData) {
            // ë³¼ë¦°ì € ë°´ë“œ ìƒíƒœ ëª¨ì˜ ê³„ì‚°
            const price = symbolData.currentPrice || 0;
            const random = Math.random();
            
            if (random < 0.3) {
                return { text: 'ìƒë‹¨ ê·¼ì ‘', status: 'warning', label: 'ì£¼ì˜' };
            } else if (random < 0.3) {
                return { text: 'í•˜ë‹¨ ê·¼ì ‘', status: 'warning', label: 'ì£¼ì˜' };
            } else {
                return { text: 'ì¤‘ê°„ëŒ€', status: 'neutral', label: 'ì¤‘ë¦½' };
            }
        }

        function calculateMockMAStatus(symbolData) {
            // ì´ë™í‰ê·  ìƒíƒœ ëª¨ì˜ ê³„ì‚°
            const price = symbolData.currentPrice || 0;
            const trend = (price % 10) / 10 - 0.5;
            
            if (trend > 0.2) {
                return { text: 'ìƒìŠ¹ ì¶”ì„¸', status: 'bullish', label: 'ìƒìŠ¹' };
            } else if (trend < -0.2) {
                return { text: 'í•˜ë½ ì¶”ì„¸', status: 'bearish', label: 'í•˜ë½' };
            } else {
                return { text: 'íš¡ë³´', status: 'neutral', label: 'ì¤‘ë¦½' };
            }
        }

        // ğŸ•˜ ê°œì¥ ë°ì´í„° ìˆ˜ì§‘
        async function collectMarketOpen() {
            try {
                logMessage('ê°œì¥ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘...', 'info');
                
                const response = await fetch(`${API_BASE}/smart-data/market-open`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.message);
                }
                
                logMessage(`ê°œì¥ ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ: ${data.successCount}/${data.totalCount} ì„±ê³µ`, 'success');
                await refreshSmartData();
                
            } catch (error) {
                logMessage(`ê°œì¥ ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ğŸ•” íì¥ ë°ì´í„° ìˆ˜ì§‘
        async function collectMarketClose() {
            try {
                logMessage('ğŸ•” íì¥ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘...', 'info');
                
                const response = await fetch(`${API_BASE}/smart-data/market-close`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.message);
                }
                
                logMessage(`ğŸ•” íì¥ ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ: ${data.successCount}/${data.totalCount} ì„±ê³µ`, 'success');
                await refreshSmartData();
                
            } catch (error) {
                logMessage(`íì¥ ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ğŸ‘€ ê´€ì‹¬ í‹°ì»¤ ì¶”ê°€
        async function addWatchedSymbol() {
            const symbol = prompt('ê´€ì‹¬ í‹°ì»¤ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: AAPL):');
            if (!symbol) return;
            
            try {
                logMessage(`ğŸ‘€ ${symbol} ê´€ì‹¬ í‹°ì»¤ ì¶”ê°€ ì¤‘...`, 'info');
                
                const response = await fetch(`${API_BASE}/smart-data/watch/${symbol}`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.message);
                }
                
                logMessage(`ğŸ‘€ ${symbol} ê´€ì‹¬ í‹°ì»¤ ì¶”ê°€ ì™„ë£Œ (5ë¶„ë§ˆë‹¤ ì—…ë°ì´íŠ¸)`, 'success');
                
            } catch (error) {
                logMessage(`ê´€ì‹¬ í‹°ì»¤ ì¶”ê°€ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ğŸ¯ 4ë‹¨ê³„ ìë™ ì „í™˜ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸
        async function testFailoverChain() {
            const testSymbols = ['AAPL', 'INVALID_SYMBOL', 'TSLA'];
            
            logMessage('ğŸ¯ 4ë‹¨ê³„ ìë™ ì „í™˜ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹œì‘...', 'info');
            logMessage('ğŸ”¥ Yahoo Finance â†’ ğŸŒ Investing.com â†’ ğŸ“Š Finviz â†’ â­ Alpha Vantage', 'info');
            
            for (const symbol of testSymbols) {
                try {
                    await searchOnDemandSymbol(symbol);
                    await new Promise(resolve => setTimeout(resolve, 1000)); // 1ì´ˆ ëŒ€ê¸°
                } catch (error) {
                    logMessage(`âš ï¸ ${symbol} í…ŒìŠ¤íŠ¸ì—ì„œ ì˜¤ë¥˜ ë°œìƒ (ì˜ˆìƒëœ ë™ì‘)`, 'warning');
                }
            }
            
            logMessage('ğŸ¯ 4ë‹¨ê³„ ìë™ ì „í™˜ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'success');
        }

        // ìˆ˜ì§‘ ì‹œì‘ í•¨ìˆ˜ (ë ˆê±°ì‹œ)
        async function startCollection() {
            try {
                const response = await fetch(`${API_BASE}/market-data/refresh`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.message);
                }
                
                logMessage('ğŸ¯ 4ë‹¨ê³„ ìë™ ì „í™˜ ì‹œìŠ¤í…œ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘', 'success');
                await refreshSmartData();
                
            } catch (error) {
                logMessage(`ìˆ˜ì§‘ ì‹œì‘ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ìˆ˜ì§‘ ì¤‘ë‹¨ í•¨ìˆ˜
        function stopCollection() {
            stopAutoRefresh();
            logMessage('ë°ì´í„° ìˆ˜ì§‘ ì¤‘ë‹¨', 'warning');
        }

        // ë¡œê·¸ ë©”ì‹œì§€ ì¶”ê°€
        function logMessage(message, type = 'info') {
            const logContainer = document.getElementById('logContainer');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
            
            // ë¡œê·¸ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ì˜¤ë˜ëœ ê²ƒ ì‚­ì œ
            const logs = logContainer.children;
            if (logs.length > 50) {
                logContainer.removeChild(logs[1]);
            }
        }

        // ë¡œê·¸ ì‚­ì œ
        function clearLogs() {
            document.getElementById('logContainer').innerHTML = `
                <div class="log-entry">
                    ë¡œê·¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ì‹œìŠ¤í…œ í™œë™ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                </div>
            `;
        }

        // ì—°ê²° ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateConnectionStatus(connected) {
            const statusElement = document.getElementById('connectionStatus');
            
            if (connected) {
                statusElement.innerHTML = '<i class="fas fa-wifi"></i> ì—°ê²°ë¨';
                statusElement.className = 'connection-status connected';
                statusElement.classList.add('pulse');
            } else {
                statusElement.innerHTML = '<i class="fas fa-wifi"></i> ì—°ê²° ëŠê¹€';
                statusElement.className = 'connection-status disconnected';
                statusElement.classList.remove('pulse');
            }
        }

        // ìµœì¢… ì—…ë°ì´íŠ¸ ì‹œê°„ ì—…ë°ì´íŠ¸
        function updateLastUpdateTime() {
            const now = new Date().toLocaleString();
            document.getElementById('lastUpdate').textContent = `ìµœì¢… ì—…ë°ì´íŠ¸: ${now}`;
        }

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function formatPrice(price) {
            if (typeof price !== 'number') return 'N/A';
            return price.toFixed(2);
        }

        function formatPercent(percent) {
            if (typeof percent !== 'number') return '0';
            return percent.toFixed(2);
        }

        function formatVolume(volume) {
            if (typeof volume !== 'number') return 'N/A';
            if (volume >= 1000000) {
                return (volume / 1000000).toFixed(1) + 'M';
            } else if (volume >= 1000) {
                return (volume / 1000).toFixed(1) + 'K';
            }
            return volume.toLocaleString();
        }

        function formatTime(timeString) {
            try {
                const date = new Date(timeString);
                return date.toLocaleTimeString();
            } catch (error) {
                return 'ì•Œ ìˆ˜ ì—†ìŒ';
            }
        }

        // í˜ì´ì§€ ì–¸ë¡œë“œì‹œ ì •ë¦¬
        window.addEventListener('beforeunload', function() {
            stopAutoRefresh();
        });
    </script>
</body>
</html>
